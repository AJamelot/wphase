/****************************************************************
*	W phase package - decimate subroutines header
*                                           
*       History
*             2010  Original Coding
*
*       Zacharie Duputel, Luis Rivera and Hiroo Kanamori
*
*****************************************************************/

#ifndef Ndec2
#define Ndec2 48
#endif

#ifndef Ndec4
#define Ndec4 91
#endif

#ifndef Ndec5
#define Ndec5 111
#endif

typedef struct{
  int     n1,n2  ;
  double *coeffs ;
} FIR_filter ;

double dec2[]={-3.3425764E-04,
	       -3.3857070E-03,
	       -1.9268941E-03,
	        8.7774985E-04,
	        1.7113149E-03,
	       -8.5958078E-04,
	       -2.1123735E-03,
	        6.8520368E-04,
	        2.6507233E-03,
	       -3.3284827E-04,
	       -3.2288394E-03,
	       -2.1560673E-04,
	        3.7930536E-03,
	        9.7627493E-04,
	       -4.2909257E-03,
	       -1.9622259E-03,
	        4.6677405E-03,
	        3.1779352E-03,
	       -4.8619559E-03,
	       -4.6201788E-03,
	        4.8062914E-03,
	        6.2755287E-03,
	       -4.4270223E-03,
	       -8.1201386E-03,
	        3.6447931E-03,
	        1.0119658E-02,
	       -2.3732848E-03,
	       -1.2231107E-02,
	        5.1414071E-04,
	        1.4404192E-02,
	        2.0550210E-03,
	       -1.6579267E-02,
	       -5.4942630E-03,
	        1.8701682E-02,
	        1.0057281E-02,
	       -2.0699021E-02,
	       -1.6146368E-02,
	        2.2516267E-02,
	        2.4537170E-02,
	       -2.4095145E-02,
	       -3.6906341E-02,
	        2.5382959E-02,
	        5.7652390E-02,
	       -2.6331840E-02,
	       -1.0303353E-01,
	        2.6915017E-02,
	        3.1978511E-01,
	        4.7732245E-01};

double dec4[]={-0.78610331E-03,
               0.17703171E-02,
               0.17342302E-02,
               0.17459453E-02,
               0.13765346E-02,
               0.60871453E-03,
               -0.29340666E-03,
               -0.94576413E-03,
               -0.10457698E-02,
               -0.54487761E-03,
               0.30336727E-03,
               0.10489000E-02,
               0.12694919E-02,
               0.79965324E-03,
               -0.15881853E-03,
               -0.11173668E-02,
               -0.15448434E-02,
               -0.11566642E-02,
               -0.93354625E-04,
               0.11186297E-02,
               0.18238572E-02,
               0.15875453E-02,
               0.45596727E-03,
               -0.10270840E-02,
               -0.20755990E-02,
               -0.20744186E-02,
               -0.93285192E-03,
               0.81899471E-03,
               0.22699400E-02,
               0.25965930E-02,
               0.15254335E-02,
               -0.47197170E-03,
               -0.23753699E-02,
               -0.31325626E-02,
               -0.22335923E-02,
               -0.36519799E-04,
               0.23592040E-02,
               0.36549442E-02,
               0.30510179E-02,
               0.72517502E-03,
               -0.21834560E-02,
               -0.41275406E-02,
               -0.39624022E-02,
               -0.16159373E-02,
               0.18078703E-02,
               0.45121713E-02,
               0.49573286E-02,
               0.27206815E-02,
               -0.11885283E-02,
               -0.47603725E-02,
               -0.60094716E-02,
               -0.40607406E-02,
               0.27697056E-03,
               0.48204092E-02,
               0.70931828E-02,
               0.56574643E-02,
               0.98837493E-03,
               -0.46254322E-02,
               -0.81806388E-02,
               -0.75423168E-02,
               -0.26885252E-02,
               0.40912377E-02,
               0.92410743E-02,
               0.97706541E-02,
               0.49446635E-02,
               -0.30995123E-02,
               -0.10243686E-01,
               -0.12446117E-01,
               -0.79624243E-02,
               0.14588218E-02,
               0.11154728E-01,
               0.15773855E-01,
               0.12122922E-01,
               0.11730746E-02,
               -0.11949001E-01,
               -0.20213991E-01,
               -0.18260375E-01,
               -0.55519193E-02,
               0.12592813E-01,
               0.26923735E-01,
               0.28548554E-01,
               0.13739644E-01,
               -0.13070323E-01,
               -0.39812922E-01,
               -0.51046878E-01,
               -0.34419119E-01,
               0.13365105E-01,
               0.83793312E-01,
               0.15848082E+00,
               0.21532360E+00,
               0.23653504E+00};
               
           

double dec5[]={0.22739838E-02,
               0.92948624E-03,
               0.76842657E-03,
               0.36705163E-03,
               -0.19336015E-03,
               -0.77180623E-03,
               -0.12058818E-02,
               -0.13651208E-02,
               -0.11960072E-02,
               -0.74757589E-03,
               -0.16124418E-03,
               0.36935217E-03,
               0.66196767E-03,
               0.60708891E-03,
               0.21137166E-03,
               -0.39880717E-03,
               -0.10119241E-02,
               -0.14018975E-02,
               -0.14061579E-02,
               -0.99059893E-03,
               -0.26810885E-03,
               0.53038984E-03,
               0.11324680E-02,
               0.13131760E-02,
               0.98129292E-03,
               0.22151141E-03,
               -0.71785948E-03,
               -0.15157261E-02,
               -0.18772145E-02,
               -0.16343265E-02,
               -0.83641545E-03,
               0.27951988E-03,
               0.13379015E-02,
               0.19636080E-02,
               0.19060248E-02,
               0.11430616E-02,
               -0.10080911E-03,
               -0.14139037E-02,
               -0.23346422E-02,
               -0.25087805E-02,
               -0.18248872E-02,
               -0.46738447E-03,
               0.11268370E-02,
               0.24096994E-02,
               0.29073050E-02,
               0.23946902E-02,
               0.98881521E-03,
               -0.86848100E-03,
               -0.25477768E-02,
               -0.34412947E-02,
               -0.31829374E-02,
               -0.17899896E-02,
               0.31702407E-03,
               0.24387422E-02,
               0.38236496E-02,
               0.39369017E-02,
               0.26567061E-02,
               0.34752686E-03,
               -0.22375220E-02,
               -0.42014252E-02,
               -0.48074462E-02,
               -0.37535410E-02,
               -0.13042900E-02,
               0.17638088E-02,
               0.44051381E-02,
               0.56554032E-02,
               0.49791960E-02,
               0.24869707E-02,
               -0.10602982E-02,
               -0.44770911E-02,
               -0.65423511E-02,
               -0.64289104E-02,
               -0.40227529E-02,
               -0.14044337E-04,
               0.42904904E-02,
               0.73840916E-02,
               0.80774855E-02,
               0.59415763E-02,
               0.15175294E-02,
               -0.38015433E-02,
               -0.81948247E-02,
               -0.10022298E-01,
               -0.84163100E-02,
               -0.36542960E-02,
               0.28455369E-02,
               0.89212917E-02,
               0.12363423E-01,
               0.11686970E-01,
               0.67212107E-02,
               -0.12011472E-02,
               -0.95601920E-02,
               -0.15406003E-01,
               -0.16343743E-01,
               -0.11430031E-01,
               -0.16730814E-02,
               0.10076012E-01,
               0.19867271E-01,
               0.23857031E-01,
               0.19629899E-01,
               0.72293030E-02,
               -0.10461548E-01,
               -0.28172743E-01,
               -0.39482988E-01,
               -0.38539425E-01,
               -0.21801252E-01,
               0.10695269E-01,
               0.54943368E-01,
               0.10361496E+00,
               0.14762825E+00,
               0.17825589E+00,
               0.18922436E+00};



int init_FIR(double *coeffs, int Ncoeffs, FIR_filter *FIR);
int decimate(FIR_filter *FIR, int dec_fac, double *yi, int ni, double *yo, int *no);
